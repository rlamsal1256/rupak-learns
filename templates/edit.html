{% extends "base.html" %}

{% block title %}Edit Note - Write Notes Helper{% endblock %}

{% block content %}
<div class="container">
    <h2>Edit Note</h2>

    <form method="POST" id="captureForm">
        <div class="form-group">
            <label for="source_url">Source URL *</label>
            <input type="url" id="source_url" name="source_url" required
                   value="{{ draft.metadata.source_url }}">
        </div>

        <div id="highlights">
            {% for highlight in draft.highlights %}
            <div class="highlight-section">
                <h3>Highlight {{ loop.index }}</h3>
                <div class="form-group">
                    <label for="quote_{{ loop.index0 }}">Quote / Highlight</label>
                    <textarea id="quote_{{ loop.index0 }}" name="quote_{{ loop.index0 }}" rows="4">{{ highlight.quote }}</textarea>
                </div>
                <div class="form-group">
                    <label for="commentary_{{ loop.index0 }}">Your Commentary</label>
                    <textarea id="commentary_{{ loop.index0 }}" name="commentary_{{ loop.index0 }}" rows="4">{{ highlight.commentary }}</textarea>
                </div>
                {% if loop.index > 1 %}
                <button type="button" class="btn btn-danger btn-small remove-highlight" data-index="{{ loop.index0 }}">
                    Remove
                </button>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <button type="button" class="btn btn-secondary" id="addHighlight">
            + Add Another Highlight
        </button>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Update Draft</button>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    let highlightCount = {{ draft.highlights|length }};
</script>
<script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}
